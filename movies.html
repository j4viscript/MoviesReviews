<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>
			Peliculas Free
		</title>
		<!-- ENLAZAR VUE JS -->
		<script src="https://unpkg.com/vue@3"></script>
		<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
        <script src="https://cdn.tailwindcss.com"></script>
        <link href="https://cdn.jsdelivr.net/npm/daisyui@2.27.0/dist/full.css" rel="stylesheet" type="text/css" />
	</head> 
	<body class="bg-white dark:bg-slate-800 rounded-lg px-6 py-8 ring-1 ring-slate-900/5 shadow-xl">
		<div id="contenedor" >
            <header id="header">
                <nav>
                    <div class="navbar bg-base-100">
                        <div class="flex-1">
                          <a class="btn btn-ghost normal-case text-xl">{{user}}</a>
                        </div>
                        <div class="flex-none">
                          <button class="btn btn-square btn-ghost">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-5 h-5 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"></path></svg>
                          </button>
                        </div>
                      </div>
                </nav>
            </header>
			<div class="flex flex-wrap justify-content">
				<div id="content" class="flex" v-for="m in movie">
					<div class="card m-10 w-96 bg-base-100 shadow-xl">
						<figure><img :src="`https://image.tmdb.org/t/p/w500/${m.poster_path}`" alt="Movies" /></figure>
							<div class="card-body">
						<h2 class="card-title">{{m.title}}</h2>
						<div class="card-actions justify-end">
							<button @click="verMas(m)" class="btn btn-primary">See More</button>
						</div>
						</div>
					</div>
				</div>
			</div>
			<footer class="footer footer-center p-4 bg-base-300 text-base-content">
				<div>
				  <p>Copyright Â© 2022 - All right reserved by Javier Oskar Murillo Cota</p>
				</div>
			  </footer>
        </div>
		
		<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
            <script type="text/javascript">
			// vincular vue con mi contenedor
			const { createApp } = Vue;  

			const app = createApp({
				data(){
					return {
						user:null, 
						inAction: 'show',
						name:'',
						id:0,
						movie: [],
					}
				},
				methods: {
					load(){
						//se ve el usuario arriba
						var usr = localStorage.getItem('user');
						usr = JSON.parse(usr);  
						this.user = usr.eml;


						////////////////////////////////////////////////////////////////
						_self = this;

						var data = new FormData();
							
						var config = {
						  method: 'get',
						  url: 'https://api.themoviedb.org/3/movie/popular?language=en-US&page=1',
						  headers: { 
							'Authorization': 'Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIwZjMzZWI5MjczNDMwYzE0OTkwNzM2MGU3ZTk1ZTVlNyIsInN1YiI6IjYzMWUyZWI4Yjg3YWVjMDA3Zjg5N2UyYiIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.VGSFNA0O6HUgqky9J7NTZU6ncl8mNstDGSTo1LWRfBM',  
						  },
						  data : data
						}; 
						axios(config)
						.then(function (response) {
							_self.movie = response.data.results
							console.log(_self.movie)
							app.$forceUpdate();

						  //console.log(JSON.stringify(response.data));
						})
						.catch(function (error) {
						  console.log(error);
						});

					},
					verMas(movies){
						var infoMovies = {
							info: movies
						}
						window.location.href = 'details.html'
						localStorage.setItem('movie', JSON.stringify(infoMovies));
						console.log(movies)
					}
				},
				mounted(){
                    this.load()
				}
			}).mount('#contenedor')
		</script>
	</body>
</html>